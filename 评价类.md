## 层次分析法

### 适用场景

**通过打分解决评价类问题。**

对于不同的评价目标，通过建立多个评价指标、形成评价体系。

### 实现细节

1. **确定评价指标** 查询资料或头脑风暴
2. **通过提问确定评价指标的权重** 两两询问重要程度，形成**判断矩阵**
3. **通过提问确定不同评价目标对相同指标的权重** 两两询问重要程度，形成**判断矩阵**
4. **处理矛盾项** 进行一致性检验，一致性指标满足条件即可使用
5. **计算权重** 算数平均值法、几何平均值法、特征值法（特征值法可能产生复数根）
6. **计算各方案的得分**

目标层（评价目的） -> 准则层（评价指标） -> 方案层（评价目标）

2、3步中，可用熵权法优化得到重要程度的步骤。但比较扯淡，因为使用数据本身的分布而非指标的实际性质决定权重。
在有实际数据的情况下，可依据实际数据确定权重指标。

### 所需假设

- 评价指标数量不过多（<=15）
- 通过询问得到的重要程度指标是准确的
- 或，通过熵权法得到的重要程度指标是准确的
  
### 可能的风险

- 重要程度指标的确定依赖专家，主观性较大
- 评价指标设计可能不完备

## TOPSIS

### 适用场景

**具有具体数值的评价项**

评价目标的待评价指标是由具体数值给出的，如分数、次数等。

### 实现细节

1. **数据清洗** 对所有数据进行指标正向化、标准化处理
2. **计算得分** 经过上一步得到了n个评价对象、m个指标的标准化矩阵，对该矩阵计算得分并归一化，得出得分矩阵
$$
\left(
\begin{matrix}
    z_{11} & z_{12} & \cdots & z_{1m} \\
    z_{21} & z_{22} & \cdots & z_{2m} \\
    \vdots & \vdots & \ddots & \vdots \\
    z_{n1} & z_{n2} & \cdots & z_{nm} \\
\end{matrix}
\right) \\~\\
\begin{aligned}
    def. Z^+ = & (Z_1^+, Z_2^+, \cdots, Z_n^+) \\
    = & (max(z_{11} \cdots z_{1m}), \cdots, max(z_{n1} \cdots z_{nm}))
\end{aligned} \\~\\
\begin{aligned}
    def. Z^- = & (Z_1^-, Z_2^-, \cdots, Z_n^-) \\
    = & (min(z_{11} \cdots z_{1m}), \cdots, min(z_{n1} \cdots z_{nm}))
\end{aligned}
$$
对第i个对象，
$$
D_i^+ = \sqrt{\sum_j^m (Z_j^+ - z_ij)^2} \\~\\
D_i^- = \sqrt{\sum_j^m (Z_j^- - z_ij)^2} \\~\\
$$
则可以计算评分
$$
S_i = \frac{D_i^-}{D_i^+ + D_i^-}
$$
   
或，对不同评价指标，可以通过层次分析法确定权重，计算$D_i^+, D_i^-$时每一项乘以权重。

### 所需假设

- 每个指标均存在数据

### 可能的风险

- 指标的选取个数选取多少为宜，以便准确刻画指标的影响力